<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tekken Ball Tournament Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #1b1b1b;
      color: #f5f5f5;
      padding: 20px;
    }
    h1 { text-align: center; }
    .tournament-list, .bracket-editor {
      margin: 20px auto;
      max-width: 1000px;
      background: #2a2a2a;
      padding: 20px;
      border-radius: 12px;
    }
    input, button D{
      padding: 6px;
      margin: 4px;
      border-radius: 6px;
      border: none;
    }
    button { cursor: pointer; background: #4caf50; color: white; }
    button.delete { background: #e53935; }
    .bracket-wrapper { display: flex; flex-direction: column; gap: 40px; }
    .bracket { display: flex; justify-content: flex-start; align-items: flex-start; overflow-x: auto; padding: 20px 0; }
    .round { display: flex; flex-direction: column; align-items: center; margin: 0 20px; }
    .round-title { text-align: center; margin-bottom: 10px; font-weight: bold; }
    .match { background: #3b3b3b; padding: 10px; border-radius: 8px; margin: 20px 0; position: relative; width: 180px; }
    .match input { display: block; width: 100%; margin: 2px 0; background: #555; color: white; }
    h3 { text-align: center; }
  </style>
</head>
<body>
  <h1>Tekken Ball Tournament Tracker</h1>

  <div class="tournament-list">
    <h2>Add Tournament</h2>
    <input type="text" id="tournamentName" placeholder="Tournament Name">
    <button id="addTournamentBtn">Add</button>

    <h2>All Tournaments</h2>
    <ul id="tournaments"></ul>
  </div>

  <div class="bracket-editor" id="bracketEditor" style="display:none;">
    <h2 id="editorTitle"></h2>
    <div class="bracket-wrapper">
      <div>
        <h3>Winners Bracket</h3>
        <div class="bracket" id="winnersBracket"></div>
      </div>
      <div>
        <h3>Losers Bracket</h3>
        <div class="bracket" id="losersBracket"></div>
      </div>
    </div>
    <button id="saveBracketBtn">Save Bracket</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      let tournaments = JSON.parse(localStorage.getItem('tournaments') || '[]');
      let editingIndex = null;
      let viewingIndex = null;

      const tournamentNameInput = document.getElementById('tournamentName');
      const addTournamentBtn = document.getElementById('addTournamentBtn');

      addTournamentBtn.addEventListener('click', function() {
        const name = tournamentNameInput.value.trim();
        if (!name) return;

        const newTournament = {
          name: name,
          winners: [{ title: 'Winners Round 1', matches: [{ p1:'Player 1', p2:'Player 2', s1:'', s2:'' }] }],
          losers: [{ title: 'Losers Round 1', matches: [{ p1:'Player 1', p2:'Player 2', s1:'', s2:'' }] }]
        };

        tournaments.push(newTournament);
        localStorage.setItem('tournaments', JSON.stringify(tournaments));
        tournamentNameInput.value = '';
        renderTournaments();
      });

      function renderTournaments() {
        const list = document.getElementById('tournaments');
        list.innerHTML = '';
        tournaments.forEach((t, i) => {
          const li = document.createElement('li');
          li.textContent = t.name;

          const editBtn = document.createElement('button');
          editBtn.textContent = 'Edit Bracket';
          editBtn.addEventListener('click', () => editTournament(i));

          const viewBtn = document.createElement('button');
          viewBtn.textContent = 'View Bracket';
          viewBtn.addEventListener('click', () => viewTournament(i));

          const delBtn = document.createElement('button');
          delBtn.textContent = 'Delete';
          delBtn.className = 'delete';
          delBtn.addEventListener('click', () => deleteTournament(i));

          li.appendChild(editBtn);
          li.appendChild(viewBtn);
          li.appendChild(delBtn);
          list.appendChild(li);
        });
      }

      function deleteTournament(i) {
        tournaments.splice(i, 1);
        localStorage.setItem('tournaments', JSON.stringify(tournaments));
        renderTournaments();
        document.getElementById('bracketEditor').style.display = 'none';
      }

      function editTournament(i) {
        editingIndex = i;
        viewingIndex = null;
        document.getElementById('editorTitle').textContent = tournaments[i].name;
        document.getElementById('bracketEditor').style.display = 'block';
        renderBrackets(true);
      }

      function viewTournament(i) {
        viewingIndex = i;
        editingIndex = null;
        document.getElementById('editorTitle').textContent = tournaments[i].name;
        document.getElementById('bracketEditor').style.display = 'block';
        renderBrackets(false);
      }

      function renderBrackets(isEditable=true) {
        renderBracket('winners', 'winnersBracket', isEditable);
        renderBracket('losers', 'losersBracket', isEditable);
      }

      function renderBracket(type, elementId, isEditable) {
        const bracketDiv = document.getElementById(elementId);
        if (!bracketDiv) return;
        bracketDiv.innerHTML = '';
        const index = editingIndex !== null ? editingIndex : viewingIndex;
        if (index === null || !tournaments[index]) return;
        const rounds = tournaments[index][type] || [];

        rounds.forEach((round, roundIdx) => {
          const roundDiv = document.createElement('div');
          roundDiv.className = 'round';

          const titleInput = document.createElement('input');
          titleInput.type = 'text';
          titleInput.placeholder = 'Round Title';
          titleInput.value = round.title || '';
          titleInput.readOnly = !isEditable;
          if(isEditable) titleInput.addEventListener('input', e => round.title = e.target.value);
          titleInput.className = 'round-title';
          roundDiv.appendChild(titleInput);

          round.matches = round.matches || [];
          round.matches.forEach((m) => {
            const matchDiv = document.createElement('div');
            matchDiv.className = 'match';
            ['p1','s1','p2','s2'].forEach(key => {
              const inp = document.createElement('input');
              inp.type = 'text';
              inp.value = m[key] || '';
              inp.placeholder = key.includes('p') ? 'Player' : 'Score';
              inp.readOnly = !isEditable;
              if(isEditable) inp.addEventListener('input', e => m[key] = e.target.value);
              matchDiv.appendChild(inp);
            });
            roundDiv.appendChild(matchDiv);
          });

          if(isEditable){
            const addMatchBtn = document.createElement('button');
            addMatchBtn.textContent = 'Add Match';
            addMatchBtn.addEventListener('click', () => { round.matches.push({p1:'Player 1', p2:'Player 2', s1:'0', s2:'0'}); renderBrackets(true); });
            roundDiv.appendChild(addMatchBtn);

            const delRoundBtn = document.createElement('button');
            delRoundBtn.textContent = 'Delete Round';
            delRoundBtn.addEventListener('click', () => { tournaments[index][type].splice(roundIdx,1); renderBrackets(true); });
            roundDiv.appendChild(delRoundBtn);
          }

          bracketDiv.appendChild(roundDiv);
        });

        if(isEditable){
          const addRoundBtn = document.createElement('button');
          addRoundBtn.textContent = 'Add Round';
          addRoundBtn.addEventListener('click', () => { tournaments[index][type].push({title:'New Round', matches:[{p1:'Player 1', p2:'Player 2', s1:'0', s2:'0'}]}); renderBrackets(true); });
          bracketDiv.appendChild(addRoundBtn);
        }
      }

      renderTournaments();
    });
  </script>
</body>
</html>
